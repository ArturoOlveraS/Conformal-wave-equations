
(*This program gives the metric transformation,  maps of geodesics and wave equation between  different coordinate systems*)


ClearAll["Global`*"]
Quiet@Block[{Print},<<xAct`xCoba`]
Quiet@Block[{Print},<<xAct`xTras`]
Quiet@Block[{Print},<<xAct`TexAct`]
$DefInfoQ=False;
$CVVerbose=False;
SetOptions[AutomaticRules,Verbose->False];
$PrePrint=ScreenDollarIndices;
$LargeComponentSize=30000;
DefManifold[M,4,IndexRange[a,p]]
DefMetric[-1,metric[-a,-b],CD,SymbolOfCovD ->{":","\[Del]"}, PrintAs -> "g"]
ChristoffelCD[a,-b,-c] // ChristoffelToMetric;

(*Coordinate transformation from crd1 to crd2,   (coordinate system1 ) to (coordinate system2) *)

DefChart[crd1,M,{0,1,2,3},{T[],R[],\[CapitalTheta][],\[CapitalPhi][]},ChartColor->Red]
DefChart[crd2,M,{0,1,2,3},{t[],r[],\[Theta][],\[Phi][]},ChartColor->Red]
crd1tocrd2:={T[]->(r[]^2+t[]^2 (1-r[])^2)/(2r[](1-r[])t[]^2), R[]->(r[]^2-t[]^2 (1-r[])^2)/(2r[](1-r[])t[]^2),\[CapitalTheta][]->\[Theta][],\[CapitalPhi][]->\[Phi][]};
crd2tocrd1:={t[]->1/Sqrt[T[]^2-R[]^2],r[]->1/(1+T[]-R[]),\[Theta][]->\[CapitalTheta][],\[Phi][]->\[CapitalPhi][]};
crd1221:=Join[ToExpression[StringDelete[ToString[crd1tocrd2, InputForm],"[]"]],ToExpression[StringDelete[ToString[crd2tocrd1, InputForm],"[]"]]]


(*this functions gives me the coordinates and its transformation and will be used in the plots*)

crd[i_,j_]:=crd1221[[i,j]]


(*Here we are building the Jacobian*)
Map[PDcrd2[-a],crd1tocrd2,{2}]//FullSimplify;
Map[ToBasis[crd2],%,{2}]//FullSimplify;
Refine[ComponentArray@%];
%/.Rule->ComponentValue;
jacobianmatrix=ToValues@ComponentArray@Basis[-{a,crd2},{b,crd1}]//FullSimplify
BasisChange->CTensor[jacobianmatrix,{-crd2, crd1}];
MatrixForm[jacobianmatrix] ;
FullSimplify[Inverse[jacobianmatrix]];
A=MatrixForm[%]
SetBasisChange[CTensor[jacobianmatrix,{-crd2,crd1}],-crd1]
Det[FullSimplify[Inverse[jacobianmatrix]]]//FullSimplify
Transforming the metric  from  crd1 to crd2    
met=CTensor[{{-1,0,0,0},{0,1,0,0},{0,0,R[]^2,0},{0,0,0,R[]^2 Sin[\[CapitalTheta][]]^2}},{-crd1,-crd1}];
metInv=CTensor[{{-1,0,0,0},{0,1,0,0},{0,0,1/R[]^2,0},{0,0,0,Csc[\[CapitalTheta][]]^2/R[]^2}},{crd1,crd1}];
met[-a,-b]
metInv[a,b]


metcrd2=ToCTensor[met,{-crd2,-crd2}]/.crd1tocrd2//FullSimplify;
metInvcrd2=ToCTensor[metInv,{crd2,crd2}]/.crd1tocrd2//FullSimplify;
metcrd2[-a,-b]
metInvcrd2[a,b]


DefConstantSymbol[a00, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K00]"]
DefConstantSymbol[a01, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K01]"]
DefConstantSymbol[a02, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K02]"]
DefConstantSymbol[a03, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K03]"]
DefConstantSymbol[a10, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K10]"]
DefConstantSymbol[a11, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K11]"]
DefConstantSymbol[a12, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K12]"]
DefConstantSymbol[a13, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K13]"]
DefConstantSymbol[a20, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K20]"]
DefConstantSymbol[a21, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K21]"]
DefConstantSymbol[a22, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K22]"]
DefConstantSymbol[a23, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K23]"]
DefConstantSymbol[a30, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K30]"]
DefConstantSymbol[a31, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K31]"]
DefConstantSymbol[a32, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K32]"]
DefConstantSymbol[a33, PrintAs -> "Subsuperscript[Overscript[a, _], IJ, K33]"]


aten=CTensor[{{a00,a01,a02,a03},{a10,a11,a12,a13},{a20,a21,a22,a23},{a30,a31,a32,a33}},{crd1,crd1}];
aten[a,b]
aIJ=ToCTensor[aten,{crd2,crd2}]/.crd1tocrd2//FullSimplify;
aIJ[a,b]
Collect[((2r[](1-r[])t[])/(r[]^2-(1-r[])^2 t[]))^2 aIJ[{0,crd2},{2,crd2}],{a02,a12},FullSimplify]


(*The wave equation*)
TableOfComponents[metcrd2[-a,-b],{-a,-crd2},{-b,-crd2}] //FullSimplify(*This is a remainder of what the metric is*)
(*From the line above facorize the conformal factor and enter the resulting metric*)
MatrixForm[conformal={
{0,-((4r[](1-r[])t[])/(r[]^2-t[]^2 (1-r[])^2)^2),0,0},
{-((4r[](1-r[])t[])/(r[]^2-t[]^2 (1-r[])^2)^2),(4t[]^2)/(r[]^2-t[]^2 (1-r[])^2)^2,0,0},
{0,0,1,0},
{0,0,0,Sin[\[Theta][]]^2}
}]

MetricInBasis[metric,-crd2,conformal];
TableOfComponents[metric[-a,-b],{-a,-crd2},{-b,-crd2}]// ToValues //MatrixForm
MetricCompute[metric,crd2,All,CVSimplify->Simplify,Verbose->False]


(*Inverse metric*)


TableOfComponents[metric[a,b],{a,crd2},{b,crd2}]// ToValues //MatrixForm
Christoffel symbols
TableOfComponents[ToBasis[crd2][Christoffel[CD,PDcrd2][a,-b,-c]],{a,crd2},{-b,-crd2},{-c,-crd2}] // ToValues ;
TableOfComponents[ChristoffelCDPDcrd2[a,-b,-c],{a,crd2},{-b,-crd2},{-c,-crd2}]  // ToValues;

(*Ricci Scalar*)
ToBasis[crd2][RicciScalarCD[]] // ToValues 
TableOfComponents[ToBasis[crd2][RicciCD[-a,-b]],{-a,-crd2},{-b,-crd2}] // ToValues // MatrixForm
Defining the Conformal Wave Equation
Defining the conformal factor
DefTensor[\[CapitalOmega][],M]
DefScalarFunction[\[Omega]]
ComponentValue[\[CapitalOmega][],\[Omega][t[],r[]]]

(*Enter here the conformal factor*)
\[Omega][x_,y_] := (y^2-x^2 (1-y)^2)/(2x^2*y(1-y))
\[CapitalOmega][] // ToValues
ChangeCovD[CD[-a][\[CapitalOmega][]],CD,PDcrd2];
TableOfComponents[ChangeCovD[CD[-a][\[CapitalOmega][]],CD,PDcrd2] ,{-a,-crd2}]  // ToValues // Simplify


(*Wave variable *)
DefTensor[u[],M]
TableOfComponents[ChristoffelCDPDcrd2[a,-b,-c],{a,crd2},{-b,-crd2},{-c,-crd2}]  // ToValues

coord:={t,r,\[Theta],\[Phi]}
affine:=affine=Simplify[TableOfComponents[ChristoffelCDPDcrd2[a,-b,-c],{a,crd2},{-b,-crd2},{-c,-crd2}] // ToValues]
listaffine:=Table[If[UnsameQ[affine[[\[Nu],\[Lambda],\[Mu]]],0],{Style[Subsuperscript[\[CapitalGamma],Row[{coord[[\[Lambda]]],coord[[\[Mu]]]}],coord[[\[Nu]]]],18],"=",Style[affine[[\[Nu],\[Lambda],\[Mu]]],14]},0],{\[Nu],1,4},{\[Lambda],1,4},{\[Mu],1,4}]
TableForm[Partition[DeleteCases[Flatten[listaffine],0],3],TableSpacing->{1,2}]
affine[[1,1,1]]
affine[[1,1,2]]



(*Wave equation*)
ToBasis[crd2][ChangeCovD[metric[a,b] CD[-a][CD[-b][u[]]],CD,PDcrd2]] // TraceBasisDummy // ToValues //FullSimplify
ToBasis[crd2][ChangeCovD[metric[a,b] CD[-a][CD[-b][(r[]^2+t[]^2 (1-r[])^2)/(2r[](1-r[])t[]^2)]],CD,PDcrd2]] // TraceBasisDummy // ToValues //FullSimplify
ToBasis[crd2][ChangeCovD[metric[a,b] CD[-a][CD[-b][(r[]^2-t[]^2 (1-r[])^2)/(2r[](1-r[])t[]^2)]],CD,PDcrd2]] // TraceBasisDummy // ToValues //FullSimplify
ToBasis[crd2][ChangeCovD[metric[a,b] CD[-a][CD[-b][\[Theta][]]],CD,PDcrd2]] // TraceBasisDummy // ToValues //FullSimplify
ToBasis[crd2][ChangeCovD[metric[a,b] CD[-a][CD[-b][\[Phi][]]],CD,PDcrd2]] // TraceBasisDummy // ToValues //FullSimplify
(-((r^2-(-1+r)^2 t^2)^2/(4 (-1+r)^2 r^2))*((-3 t^2+6 r t^2-r^2 (1+3 t^2))/(t^3-2 r t^3+r^2 t (-1+t^2))))+2((r^2-(-1+r)^2 t^2)^2/(4 (-1+r) r t))*(-((t^2-2 r t^2+r^2 (1+t^2))/((-1+r) r (t^2-2 r t^2+r^2 (-1+t^2)))))\[AliasDelimiter]//FullSimplify



(*Semilinear part*)

ToBasis[crd2][ChangeCovD[aIJ[{0,crd2},{0,crd2}]CD[{0,-crd2}][\[CapitalOmega][]]+aIJ[{0,crd2},{1,crd2}]CD[{1,-crd2}][\[CapitalOmega][]],CD,PDcrd2]]//TraceBasisDummy //ToValues//FullSimplify
Collect[%, {a11,a11}, Together]
ToBasis[crd2][ChangeCovD[aIJ[{0,crd2},{0,crd2}]CD[{0,-crd2}][\[CapitalOmega][]]+aIJ[{1,crd2},{0,crd2}]CD[{1,-crd2}][\[CapitalOmega][]],CD,PDcrd2]]//TraceBasisDummy //ToValues//FullSimplify
ToBasis[crd2][ChangeCovD[aIJ[{1,crd2},{0,crd2}]CD[{0,-crd2}][\[CapitalOmega][]]+aIJ[{1,crd2},{1,crd2}]CD[{1,-crd2}][\[CapitalOmega][]],CD,PDcrd2]]//TraceBasisDummy //ToValues//FullSimplify
ToBasis[crd2][ChangeCovD[aIJ[{0,crd2},{1,crd2}]CD[{0,-crd2}][\[CapitalOmega][]]+aIJ[{1,crd2},{1,crd2}]CD[{1,-crd2}][\[CapitalOmega][]],CD,PDcrd2]]//TraceBasisDummy //ToValues//FullSimplify
ToBasis[crd2][ChangeCovD[aIJ[{2,crd2},{0,crd2}]CD[{0,-crd2}][\[CapitalOmega][]]+aIJ[{2,crd2},{1,crd2}]CD[{1,-crd2}][\[CapitalOmega][]],CD,PDcrd2]]//TraceBasisDummy //ToValues//FullSimplify
ToBasis[crd2][ChangeCovD[aIJ[{3,crd2},{0,crd2}]CD[{0,-crd2}][\[CapitalOmega][]]+aIJ[{3,crd2},{1,crd2}]CD[{1,-crd2}][\[CapitalOmega][]],CD,PDcrd2]]//TraceBasisDummy //ToValues//FullSimplify
ToBasis[crd2][ChangeCovD[aIJ[{0,crd2},{2,crd2}]CD[{0,-crd2}][\[CapitalOmega][]]+aIJ[{1,crd2},{2,crd2}]CD[{1,-crd2}][\[CapitalOmega][]],CD,PDcrd2]]//TraceBasisDummy //ToValues//FullSimplify
ToBasis[crd2][ChangeCovD[aIJ[{0,crd2},{3,crd2}]CD[{0,-crd2}][\[CapitalOmega][]]+aIJ[{1,crd2},{3,crd2}]CD[{1,-crd2}][\[CapitalOmega][]],CD,PDcrd2]]//TraceBasisDummy //ToValues//FullSimplify
ToBasis[crd2][ChangeCovD[aIJ[{0,crd2},{0,crd2}](CD[{0,-crd2}][\[CapitalOmega][]])^2+(aIJ[{1,crd2},{0,crd2}]+aIJ[{0,crd2},{1,crd2}])CD[{0,-crd2}][\[CapitalOmega][]]CD[{1,-crd2}][\[CapitalOmega][]]+aIJ[{1,crd2},{1,crd2}](CD[{1,-crd2}][\[CapitalOmega][]])^2,CD,PDcrd2]]//TraceBasisDummy //ToValues//FullSimplify


(*Linear terms from the quasilinear part *)

DefConstantSymbol[h00, PrintAs -> "Subsuperscript[Overscript[h, _], I, 00]"]
DefConstantSymbol[h01, PrintAs -> "Subsuperscript[Overscript[h, _], I, 01]"]
DefConstantSymbol[h02, PrintAs -> "Subsuperscript[Overscript[h, _], I, 02]"]
DefConstantSymbol[h03, PrintAs -> "Subsuperscript[Overscript[h, _], I, 03]"]
DefConstantSymbol[h10, PrintAs -> "Subsuperscript[Overscript[h, _], I, 10]"]
DefConstantSymbol[h11, PrintAs -> "Subsuperscript[Overscript[h, _], I, 11]"]
DefConstantSymbol[h12, PrintAs -> "Subsuperscript[Overscript[h, _], I, 12]"]
DefConstantSymbol[h13, PrintAs -> "Subsuperscript[Overscript[h, _], I, 13]"]
DefConstantSymbol[h20, PrintAs -> "Subsuperscript[Overscript[h, _], I, 20]"]
DefConstantSymbol[h21, PrintAs -> "Subsuperscript[Overscript[h, _], I, 21]"]
DefConstantSymbol[h22, PrintAs -> "Subsuperscript[Overscript[h, _], I, 22]"]
DefConstantSymbol[h23, PrintAs -> "Subsuperscript[Overscript[h, _], I, 23]"]
DefConstantSymbol[h30, PrintAs -> "Subsuperscript[Overscript[h, _], I, 30]"]
DefConstantSymbol[h31, PrintAs -> "Subsuperscript[Overscript[h, _], I, 31]"]
DefConstantSymbol[h32, PrintAs -> "Subsuperscript[Overscript[h, _], I, 32]"]
DefConstantSymbol[h33, PrintAs -> "Subsuperscript[Overscript[h, _], I, 33]"]


htenQ=CTensor[{{h00,h01,h02,h03},{h10,h11,h12,h13},{h20,h21,h22,h23},{h30,h31,h32,h33}},{crd1,crd1}];
hten[a,b]
htenQ=CTensor[{{h00,h01,h02,h03},{h10,h11,h12,h13},{h20,h21,h22,h23},{h30,h31,h32,h33}},{crd1,crd1}];
hten[a,b]
hIJ=ToCTensor[hten,{crd2,crd2}]/.crd1tocrd2//FullSimplify;
hIJ[a,b]
ChangeCovD[CD[{0,-crd2}][\[CapitalOmega][]],CD,PDcrd2]// ToValues //FullSimplify
ChangeCovD[CD[{1,-crd2}][\[CapitalOmega][]],CD,PDcrd2]// ToValues //FullSimplify
ToBasis[crd2][ChangeCovD[4hIJ[{0,crd2},{0,crd2}]CD[{0,-crd2}][\[CapitalOmega][]]+2(hIJ[{0,crd2},{1,crd2}]+hIJ[{1,crd2},{0,crd2}])CD[{1,-crd2}][\[CapitalOmega][]],CD,PDcrd2]] // TraceBasisDummy // ToValues //FullSimplify
ToBasis[crd2][ChangeCovD[metric[-a,-b]hIJ[a,b],CD,PDcrd2]] // TraceBasisDummy // ToValues //FullSimplify
ToBasis[crd2][ChangeCovD[(metric[{0,crd2},{0,crd2}]CD[{0,-crd2}][\[CapitalOmega][]]+metric[{1,crd2},{0,crd2}]CD[{1,-crd2}][\[CapitalOmega][]]),CD,PDcrd2]] // TraceBasisDummy // ToValues //FullSimplify
ToBasis[crd2][ChangeCovD[4hIJ[{1,crd2},{1,crd2}]CD[{1,-crd2}][\[CapitalOmega][]]+2(hIJ[{0,crd2},{1,crd2}]+hIJ[{1,crd2},{0,crd2}])CD[{0,-crd2}][\[CapitalOmega][]],CD,PDcrd2]] // TraceBasisDummy // ToValues //FullSimplify
ToBasis[crd2][ChangeCovD[(metric[{0,crd2},{1,crd2}]CD[{0,-crd2}][\[CapitalOmega][]]+metric[{1,crd2},{1,crd2}]CD[{1,-crd2}][\[CapitalOmega][]]),CD,PDcrd2]] // TraceBasisDummy // ToValues //FullSimplify
 
ToBasis[crd2][ChangeCovD[(hIJ[{0,crd2},{2,crd2}]+hIJ[{2,crd2},{0,crd2}])CD[{0,-crd2}][\[CapitalOmega][]]+(hIJ[{1,crd2},{2,crd2}]+hIJ[{2,crd2},{1,crd2}])CD[{1,-crd2}][\[CapitalOmega][]],CD,PDcrd2]]//ToValues//FullSimplify
ToBasis[crd2][ChangeCovD[(hIJ[{0,crd2},{3,crd2}]+hIJ[{3,crd2},{0,crd2}])CD[{0,-crd2}][\[CapitalOmega][]]+(hIJ[{1,crd2},{3,crd2}]+hIJ[{3,crd2},{1,crd2}])CD[{1,-crd2}][\[CapitalOmega][]],CD,PDcrd2]]//ToValues//FullSimplify
      CD[-a][CD[-b][\[CapitalOmega][]]]          
hIJ[a,b](-\[CapitalOmega][]CD[-a][CD[-b][\[CapitalOmega][]]]+4CD[-a][\[CapitalOmega][]]CD[-b][\[CapitalOmega][]]-metric[-a,-b]metric[c,d]CD[-c][\[CapitalOmega][]]CD[-d][\[CapitalOmega][]])

ToBasis[crd2][ChangeCovD[hIJ[a,b](-\[CapitalOmega][]CD[-a][CD[-b][\[CapitalOmega][]]]+4CD[-a][\[CapitalOmega][]]CD[-b][\[CapitalOmega][]]-metric[-a,-b]metric[c,d]CD[-c][\[CapitalOmega][]]CD[-d][\[CapitalOmega][]]),CD,PDcrd2]]//TraceBasisDummy //ToValues//Simplify
hten[a,b]

hIJ[a,b](-\[CapitalOmega][]CD[-a][CD[-b][\[CapitalOmega][]]]+4CD[-a][\[CapitalOmega][]]CD[-b][\[CapitalOmega][]]-metric[-a,-b]metric[c,d]CD[-c][\[CapitalOmega][]]CD[-d][\[CapitalOmega][]])
Collect[((2r[](1-r[])t[])/(r[]^2-(1-r[])t[]))^2 hIJ[{0,crd2},{2,crd2}],{h02,h12},FullSimplify]
ToBasis[crd2][ChangeCovD[hIJ[a,b](-\[CapitalOmega][]CD[-a][CD[-b][\[CapitalOmega][]]]+4CD[-a][\[CapitalOmega][]]CD[-b][\[CapitalOmega][]]-metric[-a,-b]metric[c,d]CD[-c][\[CapitalOmega][]]CD[-d][\[CapitalOmega][]]),CD,PDcrd2]]//TraceBasisDummy //ToValues//Simplify
FullSimplify[(hIJ[{0,crd2},{2,crd2}]+hIJ[{2,crd2},{0,crd2}]) 1/(4t[]^3)]
ToBasis[crd2][ChangeCovD[\[CapitalOmega][]^-2 (hIJ[{0,crd2},{3,crd2}]+hIJ[{3,crd2},{0,crd2}]) 1/(4t[]^3),CD,PDcrd2]]//TraceBasisDummy //ToValues//FullSimplify
FullSimplify[((Subsuperscript[Overscript[h, _], I, 03]+Subsuperscript[Overscript[h, _], I, 30]) (-1+r) r^3+(Subsuperscript[Overscript[h, _], I, 03]+Subsuperscript[Overscript[h, _], I, 30]) (-1+r)^3 r t)/(r^2 (-1+t)+t-2 r t)^2]
FullSimplify[((-Subsuperscript[Overscript[h, _], I, 13]-Subsuperscript[Overscript[h, _], I, 31]) (-1+r) r^3+(Subsuperscript[Overscript[h, _], I, 13]+Subsuperscript[Overscript[h, _], I, 31]) (-1+r)^3 r t)/(r^2 (-1+t)+t-2 r t)^2]
CollectConstants[FullSimplify[\[CapitalOmega][]^-2 (hIJ[{0,crd2},{3,crd2}]+hIJ[{3,crd2},{0,crd2}]) 1/(4t[]^3)],FullSimplify]
FullSimplify[(hIJ[{1,crd2},{3,crd2}]+hIJ[{3,crd2},{1,crd2}]) 1/(4t[]^2)]
FullSimplify[(hIJ[{1,crd2},{2,crd2}]+hIJ[{2,crd2},{1,crd2}]) 1/(4t[]^2)]
ToValues[hIJ[{0,crd2},{0,crd2}]/(4t[]^3)+(hIJ[{0,crd2},{0,crd2}]ChristoffelCDPDcrd2[{0,crd2},{0,-crd2},{0,-crd2}]+(hIJ[{0,crd2},{1,crd2}]+hIJ[{1,crd2},{0,crd2}])ChristoffelCDPDcrd2[{0,crd2},{0,-crd2},{1,-crd2}]) 1/(4t[]^2)]//FullSimplify
FullSimplify[((Subsuperscript[Overscript[h, _], I, 00]-Subsuperscript[Overscript[h, _], I, 01]-Subsuperscript[Overscript[h, _], I, 10]+Subsuperscript[Overscript[h, _], I, 11]) r^6+(Subsuperscript[Overscript[h, _], I, 00]-Subsuperscript[Overscript[h, _], I, 01]-Subsuperscript[Overscript[h, _], I, 10]+Subsuperscript[Overscript[h, _], I, 11]) (-1+r)^2 r^4 t)/(4 (-1+r)^2 r^2 t (r^2 (-1+t)+t-2 r t))]
FullSimplify[(-(Subsuperscript[Overscript[h, _], I, 00]+Subsuperscript[Overscript[h, _], I, 01]+Subsuperscript[Overscript[h, _], I, 10]+Subsuperscript[Overscript[h, _], I, 11]) (-1+r)^4 r^2 t^2-(Subsuperscript[Overscript[h, _], I, 00]+Subsuperscript[Overscript[h, _], I, 01]+Subsuperscript[Overscript[h, _], I, 10]+Subsuperscript[Overscript[h, _], I, 11]) (-1+r)^6 t^3)/(4 (-1+r)^2 r^2 t (r^2 (-1+t)+t-2 r t))]



ToValues[(hIJ[{1,crd2},{1,crd2}](1-2r[]))/(4r[]^2 (1-r[])^2 t[])+(1/(4t[]r[](1-r[])))hIJ[{1,crd2},{1,crd2}]ChristoffelCDPDcrd2[{1,crd2},{1,-crd2},{1,-crd2}]]//FullSimplify
